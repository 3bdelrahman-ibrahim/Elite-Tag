<!DOCTYPE html>
<html>
  <head>
    <title>Send Message</title>
    <script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@firebase/firestore@3.6.0/dist/firestore.umd.js"></script>
  </head>
  <body>
    <h1>Send Message</h1>
    <form id="messageForm">
      <label for="name">Name:</label><br />
      <input type="text" id="name" name="name" /><br /><br />
      <label for="phone">Phone:</label><br />
      <input type="tel" id="phone" name="phone" /><br /><br />
      <label for="message">Message:</label><br />
      <textarea id="message" name="message"></textarea><br /><br />
      <button type="button" onclick="getLocation()">Get Location</button
      ><br /><br />
      <label for="location">Location:</label><br />
      <input type="text" id="location" name="location" readonly /><br /><br />
      <button type="button" onclick="sendMessage()">Send Message</button>
    </form>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const latitude = position.coords.latitude;
              const longitude = position.coords.longitude;
              document.getElementById(
                "location"
              ).value = `${latitude}, ${longitude}`;
            },
            (error) => {
              console.error("Error getting location", error);
              alert("Error getting location");
            }
          );
        } else {
          alert("Geolocation is not supported by this browser.");
        }
      }

      function sendMessage() {
        const name = document.getElementById("name").value;
        const phone = document.getElementById("phone").value;
        const location = document.getElementById("location").value;
        const message = document.getElementById("message").value;

        db.collection("messages")
          .add({
            name: name,
            phone: phone,
            location: location,
            message: message,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          })
          .then(() => {
            alert("Message sent successfully!");
          })
          .catch((error) => {
            console.error("Error sending message", error);
            alert("Failed to send message");
          });
      }
    </script>
  </body>
</html>
